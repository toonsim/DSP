%% Generate impuls sound
fs = 16000;
nbsecs = 1;
impuls = [1; zeros(fs*nbsecs - 1,1)];
%% initialize parameters
[simin,nbsecs,fs]=initparams(impuls,fs);
%% run simulink recplay
sim('recplay');
%% create output
out=simout.signals.values;
%% get relevant output
delayest = floor(fs*2.12);
outrel = out(delayest:end,:);
%% plot response
samples = linspace(0,nbsecs*fs-delayest,size(outrel, 1))';
plot(samples,outrel);
% the estimated impulse response time = 400samples * fs = 0.025
%% plot magnitude of freq response
fresp = fft(outrel);
Mfresp = abs(fresp(0:(end/2),1));
freqrange = linspace(-fs/2,0,size(Mfresp,1));
semilogy(freqrange, Mfresp);

